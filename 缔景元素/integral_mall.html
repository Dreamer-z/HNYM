<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="format-detection" content="telphone=no, email=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="robots" content="index,follow" />
    <title>积分商城</title>
    <link rel="stylesheet" href="./css/init.css">
    <link rel="stylesheet" href="./css/all.css">
    <script src="./js/jquery-1.8.3.min.js"></script>
    <script src="./js/adaptive.js"></script>
    <script type="text/javascript">
        window['adaptive'].desinWidth = 750;
        window['adaptive'].baseFont = 28;
        window['adaptive'].maxWidth = 480;
        window['adaptive'].scaleType = 1;
        window['adaptive'].init();
    </script>
</head>

<body>
    <div class="iMallHead">
        <div class="member" style="background: url(./img/member_2_on.png)no-repeat 0 .08rem;background-size: 34%">
            <div class="memberLevel">
                <p class="level">黄金会员</p>
                <p class="privileges">全场9折</p>
            </div>
        </div>
        <div class="integral">当前积分：<span>3000</span></div>
    </div>
    <div class="iMallList">
        <div class="iMallLi">
            <div class="photo" style="background: url(./img/ls/bg_big.png)no-repeat center;background-size: cover;
    background-color: #ddd;"></div>
            <div class="price">300积分</div>
            <div class="cashInp">
                <span>立即兑换</span>
            </div>
        </div>
        <div class="iMallLi">
            <div class="photo" style="background: url(./img/ls/menbe_activity.png)no-repeat center;background-size: cover;
    background-color: #ddd;"></div>
            <div class="price">500积分</div>
            <div class="cashInp">
                <span>立即兑换</span>
            </div>
        </div>
    </div>
    <!-- 兑换券选项 -->
    <div class="iMall-zzc fullscreen">
        <div class="ticket-box">
            <div class="comNum">
                <div class="comimg" style="background:url(./img/ls/myWorks_1.png)no-repeat 0 .05rem;background-size: 100% 100%;background-color:#fff;"></div>
                <div class="name elli"></div>
                <div class="price"></div>
            </div>
            <div class="nbbox clear">
                <div class="onbook-op fr clear">
                    <span class="sub fl" data="adult_sub"></span>
                    <input id="adult" class="onbook-adult fl" type="number" name="onbook-adult" value="1" disabled>
                    <span class="add fl" data="adult_add"></span>
                </div>
            </div>
            <div class="confirm">确定</div>
        </div>
    </div>
</body>
<script src="./js/all.js"></script>
<script>
    // 加入购物车选项
    function nb() {
        // function allnum(pnum) {
        //     $(".ocnum").html(pnum);
        //     $(".comNum .price span").html(pnum * Number($(".comPrice").children("span").html()));
        //     $(".aggregate").html(pnum * Number($(".ocPrice").html()));
        // };
        // 数量选择 
        var pnum;
        var len;
        var type = "";
        var allpeo;
        $(".add").click(function() {
            $(this).addClass("add-cl");
            $(this).siblings(".sub").removeClass("sub-cl");
            pnum = $(this).siblings("input").val();
            pnum++;
            $(this).siblings("input").val(pnum);
            // allnum(pnum);
        });
        $(".sub").click(function() {
            $(this).addClass("sub-cl");
            $(this).siblings(".add").removeClass("add-cl");
            if ($(this).siblings("input").val() == 0) {
                return;
            };
            pnum = $(this).siblings("input").val();
            pnum--;
            $(this).siblings("input").val(pnum);
            // allnum(pnum);
        });
    };
    nb();

    function ticket() {
        $(".iMallLi .cashInp span").click(function(ev) {
            ev.stopPropagation();
            // 兑换券标题
            $(".comNum .name").text("xxx兑换券,css样式1211行");
            // 兑换所需积分
            $(".comNum .price").text($(this).parent(".cashInp").siblings(".price").html());
            $(".iMall-zzc").css("display", "block");
            $(".ticket-box").slideDown(200);
            $(document).click(function(ev) {
                if (ev.target == $(".ticket-box")[0] || ev.target ==
                    $(".onbook-op")[0] || ev.target == $(".onbook-op .sub")[0] || ev.target == $(".onbook-op .onbook-adult")[0] || ev.target ==
                    $(".onbook-op .add")[0] || ev.target == $(".donfirm")[0] || ev.target == $(".comNum")[0] || ev.target == $(".comNum .comimg")[0] ||
                    ev.target == $(".comNum .name")[0] || ev.target == $(".comNum .price")[0] || ev.target == $(".comNum .price span")[0] ||
                    ev.target == $(".nbbox")[0]) {
                    return;
                } else {
                    $(".iMall-zzc").slideUp(200);
                    $(".ticket-box").slideUp(200);
                }
            });
            $(".confirm").click(function() {
                $(".iMall-zzc").slideUp(200);
                $(".ticket-box").slideUp(200);
            });
        });
    };
    ticket();
</script>

</html>