<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="format-detection" content="telphone=no, email=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="robots" content="index,follow" />
    <title>钱包</title>
    <link rel="stylesheet" href="./css/init.css">
    <link rel="stylesheet" href="./css/public.css">
    <link rel="stylesheet" href="./css/all.css">
    <script src="./js/jquery-1.8.3.min.js"></script>
    <script src="./js/adaptive.js"></script>
    <script type="text/javascript">
        window['adaptive'].desinWidth = 750;
        window['adaptive'].baseFont = 28;
        window['adaptive'].maxWidth = 480;
        window['adaptive'].scaleType = 1;
        window['adaptive'].init();
    </script>
    <style>
        p {
            margin: 0;
        }
    </style>
</head>

<body>
    <div class="total1">
        <div class="title">账户余额（元）</div>
        <div class="totalNum">5000</div>
    </div>
    <div class="wallet-tData1 tData">
        <div class="clear">
            <p class="fl">总消费(充值)：</p>
            <p class="cont fl">￥<span>10000</span></p>
        </div>
    </div>
    <div class="wallet-tData2 tData">
        <div class="clear">
            <p class="fl">消费记录</p>
            <input id="picker-name" class="cont fl" value="2017-05">
            <p class="option fr"></p>
        </div>
        <div class="wallet-filtrate">
            <div class="title clear">
                <span class="changType fl">按月选择</span>
                <span class="affirm fr">确认</span>
            </div>
            <div class="selVal"><input placeholder="请选择..."></div>
            <div class="selType selType1">
                <div class="filtrate-select filtrate-select1" size="3">

                </div>
            </div>
            <div class="selType selType2">
                <div class="filtrate-select filtrate-select2" size="3"></div>
                <div class="filtrate-select filtrate-select3" size="3">
                    <div status="0">1</div>
                    <div status="0">2</div>
                    <div status="0">3</div>
                    <div status="0">4</div>
                    <div status="0">5</div>
                    <div status="0">6</div>
                    <div status="1">7</div>
                    <div status="0">8</div>
                    <div status="0">9</div>
                    <div status="0">10</div>
                    <div status="0">11</div>
                    <div status="0">12</div>
                </div>
            </div>
            <!-- <div class="selType selType1">
                <select class="filtrate-select filtrate-select1" size="3">

                </select>
            </div>
            <div class="selType selType2">
                <select class="filtrate-select filtrate-select2" size="3">
                    
                </select>
                <select class="filtrate-select filtrate-select3" size="3">
                    <option value="">1</option>
                    <option value="">2</option>
                    <option value="" selected>3</option>
                    <option value="">3</option>
                    <option value="">4</option>
                    <option value="">5</option>
                    <option value="">6</option>
                    <option value="">7</option>
                    <option value="">8</option>
                    <option value="">9</option>
                    <option value="">10</option>
                    <option value="">11</option>
                    <option value="">12</option>
                </select>
            </div> -->
        </div>
    </div>
    <div class="wallet-record">
        <div class="recordLi">
            <div class="stateTime">
                <p class="state">充值</p>
                <p class="time">05-25 09:56</p>
            </div>
            <div class="price">+￥200</div>
        </div>
        <div class="recordLi">
            <div class="stateTime">
                <p class="state">付款</p>
                <p class="time">05-25 09:56</p>
            </div>
            <div class="price">-￥280</div>
        </div>
    </div>

</body>
<script src="./js/module.js"></script>
<script>
    var status = 1;
    $(".changType").click(function() {
        status++;
        if (status % 2 == 0) {
            $(".changType").html("按年选择");
            $(".selType2").css("display", "block");
            $(".selType1").css("display", "none");
            return a();
        } else {
            $(".changType").html("按月选择");
            $(".selType1").css("display", "block");
            $(".selType2").css("display", "none");
            return $(".filtrate-select1").clikc();
        };
    });

    // function a() {
    //     $(".filtrate-select2").clikc();
    //     $(".filtrate-select2 option").click(function() {
    //         return $(".filtrate-select3").clikc();
    //     });
    // };
    var c1 = 1;
    $("#picker-name").click(function(ev) {
        ev.stopPropagation();
        tc();
    });
    $(".option").click(function(ev) {
        ev.stopPropagation();
        tc();
    });

    function tc() {
        c1++;
        if (c1 % 2 == 0) {
            $(".wallet-filtrate").fadeIn(100);
            if (status % 2 == 0) {
                $(".selType2").css("display", "block");
                $(".selType1").css("display", "none");
            } else {
                $(".selType1").css("display", "block");
                $(".selType2").css("display", "none");
            };
        } else {
            $(".wallet-filtrate").fadeOut(100);
        };
        $(document).click(function(ev) {
            if (ev.target == $(".wallet-filtrate")[0] || ev.target == $(".title")[0] || ev.target == $(".changType")[0] || ev.target == $(".affirm")[0] || ev.target == $(".selVal")[0] || ev.target == $(".selVal input")[0] || ev.target == $(".selType")[0] || ev.target == $(".filtrate-select")[0]) {
                return;
            };
            $(".wallet-filtrate").fadeOut(100);
        })
    };
    $(".filtrate-select1 option").click(function() {
        if (status % 2 != 0) {
            $("#picker-name").val($(".filtrate-select1").find("option:selected").text());
            $(".selVal input").val($(".filtrate-select1").find("option:selected").text());
        };
    });
    $(".filtrate-select3 option").click(function() {
        var a = $(".filtrate-select2").find("option:selected").text();
        var b = $(".filtrate-select3").find("option:selected").text()
        $("#picker-name").val(a + "-" + b);
        $(".selVal input").val(a + "-" + b);
    });
    $(".affirm").click(function() {
        $(".wallet-filtrate").css("display", "none");
        result();
    });
    document.addEventListener("change", function() {
        result();
    });

    function result() {
        if (status % 2 != 0) {
            $("#picker-name").val($(".filtrate-select1").find("option:selected").text());
            $(".selVal input").val($(".filtrate-select1").find("option:selected").text());
        } else {
            var a = $(".filtrate-select2").find("option:selected").text();
            var b = $(".filtrate-select3").find("option:selected").text()
            $("#picker-name").val(a + " - " + b);
            $(".selVal input").val(a + " - " + b);
        };
    };
    // 年份起始、结尾、初始值
    function selectFn1(dom, star, end, init) {
        var b = star;
        var a = init - star;
        console.log(a);
        for (let i = b; i <= end; i++) {
            if (i == init) {
                $("<option>", {
                    value: i,
                    text: i,
                    selected: "selected"
                }).appendTo($(dom));
            } else {
                $("<option>", {
                    value: i,
                    text: i
                }).appendTo($(dom));
            }
        };
    };
    selectFn1(".filtrate-select1", 1980, 2300, 2017);
    selectFn1(".filtrate-select2", 1980, 2300, 2017);
</script>

</html>